import{C as j}from"./ChildSidebar-DVOFlG0s.js";import{d as D,r as C,H as w,c as h,b as u,e as s,C as F,f as e,t as i,w as k,x as A,s as l,o as f,N as z,z as E,l as B,m as I,k as d,J as L,F as P,_ as H}from"./index-CmLhLd9c.js";const M={class:"container"},U={class:"msg-wrapper"},J={class:"add-comment"},O={class:"wrapper"},Y={class:"requests"},G={class:"table-container"},K={class:"row head"},Q={class:"row"},W=D({__name:"viewStudentEnrollmentRequests",setup(X){const c=C([]),N=new w("get_request_enrollment");async function x(){c.value=[],N.callApi().then(n=>{var o;if((n==null?void 0:n.success)==!0)for(let t of(o=n==null?void 0:n.data)==null?void 0:o.requests)(t==null?void 0:t.package_type)=="course"?new w("get_course").callApi({course_id:t==null?void 0:t.course_id}).then(a=>{var p,_,v;(a==null?void 0:a.success)==!0&&((v=c.value)==null||v.push({id:t==null?void 0:t.id,courseTitle:l((_=(p=a==null?void 0:a.data)==null?void 0:p.course)==null?void 0:_.title),date:$(t==null?void 0:t.created_at),status:t==null?void 0:t.status,price:t==null?void 0:t.price,comments:t==null?void 0:t.comments}),r.value="",c.value.sort((S,y)=>S.id.localeCompare(y.id)))}):(t==null?void 0:t.package_type)=="plan"&&new w("get_plan").callApi({plan_id:t==null?void 0:t.course_id}).then(a=>{var p,_,v;(a==null?void 0:a.success)==!0&&((v=c.value)==null||v.push({id:t==null?void 0:t.id,courseTitle:l((_=(p=a==null?void 0:a.data)==null?void 0:p.plan)==null?void 0:_.title),date:$(t==null?void 0:t.created_at),status:t==null?void 0:t.status,price:t==null?void 0:t.price,comments:t==null?void 0:t.comments}),r.value="",c.value.sort((S,y)=>S.id.localeCompare(y.id)))})})}x();function $(n){const o=new Date(n),t=o.getFullYear(),m=(o.getMonth()+1).toString().padStart(2,"0"),a=o.getDate().toString().padStart(2,"0");return`${t}-${m}-${a}`}const b=C(!1),g=C(-1),r=C("");function T(){let n={enrollment_request_id:c.value[g.value].id,msg:{msg:r.value}};new w("add_comment").callApi(n).then(t=>{t!=null&&t.success&&x()})}function V(n){if(n=="Pending")return l(d.pendding);if(n=="Rejected")return l(d.rejected);if(n=="Success")return l(d.succeess)}return(n,o)=>(f(),h(k,null,[u(z),s("div",M,[u(e(L),{visible:b.value,"onUpdate:visible":o[1]||(o[1]=t=>b.value=t),modal:"",header:e(l)(e(d).showComments),style:{width:"50vw"}},{default:F(()=>[s("div",U,[(f(!0),h(k,null,A(c.value[g.value].comments,t=>(f(),h("div",{class:E(["msg",{admin:(t==null?void 0:t.sender_type)=="Admin",parent:(t==null?void 0:t.sender_type)=="Parent"}])},i(t.msg),3))),256))]),s("div",J,[u(e(B),{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=t=>r.value=t)},null,8,["modelValue"]),u(e(I),{label:e(l)(e(d).addComment),onClick:T},null,8,["label"])])]),_:1},8,["visible","header"]),u(j,{class:"sidebar",selected:"requests"}),s("div",O,[s("div",Y,[s("h2",null,i(e(l)(e(d).enrollmentRequests)),1),s("div",G,[s("div",K,[s("h3",null,i(e(l)(e(d).courseTitle)),1),s("h3",null,i(e(l)(e(d).price)),1),s("h3",null,i(e(l)(e(d).date)),1),s("h3",null,i(e(l)(e(d).status)),1),s("h3",null,i(e(l)(e(d).actions)),1)]),(f(!0),h(k,null,A(c.value,(t,m)=>(f(),h("div",Q,[s("span",null,i(t.courseTitle),1),s("span",null,i(t.price)+" L.E.",1),s("span",null,i(t.date),1),s("span",{class:E({pending:t.status=="Pending",rejected:t.status=="Rejected",accepted:t.status=="Success"})},i(V(t.status)),3),s("span",null,[u(e(I),{onClick:a=>{g.value=m,b.value=!0},style:{"font-size":"0.75rem"},label:e(l)(e(d).showComments)},null,8,["onClick","label"])])]))),256))])])])]),u(P)],64))}}),q=H(W,[["__scopeId","data-v-bc1450e8"]]);export{q as default};
