import{P as F}from"./ParentSidebar-BSpEVs_g.js";import{d as H,r as y,H as C,c as w,b as r,e as a,A as L,f as t,t as n,q as E,v as N,s,o as b,N as z,C as P,l as T,k as o,B as M,F as U,_ as O}from"./index-DxsqX4w4.js";import{s as Y}from"./inputtext.esm-Cho3Xied.js";const G={class:"container"},J={class:"msg-wrapper"},K={class:"add-comment"},Q={class:"wrapper"},W={class:"requests"},X={class:"table-container"},Z={class:"row head"},R={class:"row"},q=H({__name:"parentHome",setup(ee){const u=y([]),V=new C("get_request_enrollment");async function $(){u.value=[],V.callApi().then(l=>{var i;if(l.success==!0)for(let e of(i=l==null?void 0:l.data)==null?void 0:i.requests)new C("personal_another_user_info").callApi({another_userId:e==null?void 0:e.student_id}).then(c=>{c.success==!0&&((e==null?void 0:e.package_type)=="course"?new C("get_course").callApi({course_id:e==null?void 0:e.course_id}).then(d=>{var p,_,h,f,v;d.success==!0&&((v=u.value)==null||v.push({id:e==null?void 0:e.id,childEmail:(_=(p=c==null?void 0:c.data)==null?void 0:p.info)==null?void 0:_.email,courseTitle:s((f=(h=d==null?void 0:d.data)==null?void 0:h.course)==null?void 0:f.title),date:x(e==null?void 0:e.created_at),status:e==null?void 0:e.status,price:e==null?void 0:e.price,comments:e==null?void 0:e.comments}),m.value="",u.value.sort((I,A)=>I.id.localeCompare(A.id)))}):(e==null?void 0:e.package_type)=="plan"&&new C("get_plan").callApi({plan_id:e==null?void 0:e.course_id}).then(d=>{var p,_,h,f,v;d.success==!0&&((v=u.value)==null||v.push({id:e==null?void 0:e.id,childEmail:(_=(p=c==null?void 0:c.data)==null?void 0:p.info)==null?void 0:_.email,courseTitle:s((f=(h=d==null?void 0:d.data)==null?void 0:h.plan)==null?void 0:f.title),date:x(e==null?void 0:e.created_at),status:e==null?void 0:e.status,price:e==null?void 0:e.price,comments:e==null?void 0:e.comments}),m.value="",u.value.sort((I,A)=>I.id.localeCompare(A.id)))}))})})}$();function x(l){const i=new Date(l),e=i.getFullYear(),g=(i.getMonth()+1).toString().padStart(2,"0"),c=i.getDate().toString().padStart(2,"0");return`${e}-${g}-${c}`}const S=y(!1),k=y(-1),m=y("");function j(){let l={enrollment_request_id:u.value[k.value].id,msg:{msg:m.value}};new C("add_comment").callApi(l).then(e=>{e.success&&$()})}function B(l){if(l=="Pending")return s(o.pendding);if(l=="Rejected")return s(o.rejected);if(l=="Success")return s(o.succeess)}return(l,i)=>(b(),w(E,null,[r(z),a("div",G,[r(t(M),{visible:S.value,"onUpdate:visible":i[1]||(i[1]=e=>S.value=e),modal:"",header:t(s)(t(o).showComments),style:{width:"50vw"}},{default:L(()=>[a("div",J,[(b(!0),w(E,null,N(u.value[k.value].comments,e=>(b(),w("div",{class:P(["msg",{admin:(e==null?void 0:e.sender_type)=="Admin",parent:(e==null?void 0:e.sender_type)=="Parent"}])},n(e.msg),3))),256))]),a("div",K,[r(t(Y),{modelValue:m.value,"onUpdate:modelValue":i[0]||(i[0]=e=>m.value=e)},null,8,["modelValue"]),r(t(T),{label:t(s)(t(o).addComment),onClick:j},null,8,["label"])])]),_:1},8,["visible","header"]),r(F,{class:"sidebar",selected:"enrollmentsRequests"}),a("div",Q,[a("div",W,[a("h2",null,n(t(s)(t(o).enrollmentRequests)),1),a("div",X,[a("div",Z,[a("h3",null,n(t(s)(t(o).childEmail)),1),a("h3",null,n(t(s)(t(o).courseTitle)),1),a("h3",null,n(t(s)(t(o).price)),1),a("h3",null,n(t(s)(t(o).date)),1),a("h3",null,n(t(s)(t(o).status)),1),a("h3",null,n(t(s)(t(o).actions)),1)]),(b(!0),w(E,null,N(u.value,(e,g)=>(b(),w("div",R,[a("span",null,n(e.childEmail),1),a("span",null,n(e.courseTitle),1),a("span",null,n(e.price)+" L.E.",1),a("span",null,n(e.date),1),a("span",{class:P({pending:e.status=="Pending",rejected:e.status=="Rejected",accepted:e.status=="Success"})},n(B(e.status)),3),a("span",null,[r(t(T),{onClick:c=>{k.value=g,S.value=!0},style:{"font-size":"0.75rem"},label:t(s)(t(o).showComments)},null,8,["onClick","label"])])]))),256))])])])]),r(U)],64))}}),le=O(q,[["__scopeId","data-v-ed84b8ee"]]);export{le as default};
