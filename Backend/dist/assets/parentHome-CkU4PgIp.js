import{P as F}from"./ParentSidebar-DLuUTrHE.js";import{d as H,r as y,H as w,c as C,b as r,e as a,B as L,f as e,t as i,v as A,w as D,s,o as b,N as z,D as N,l as M,m as P,k as o,C as U,F as O,_ as Y}from"./index-Ue6_DIV6.js";const G={class:"container"},J={class:"msg-wrapper"},K={class:"add-comment"},Q={class:"wrapper"},W={class:"requests"},X={class:"table-container"},Z={class:"row head"},q={class:"row"},R=H({__name:"parentHome",setup(tt){const u=y([]),T=new w("get_request_enrollment");async function $(){u.value=[],T.callApi().then(l=>{var c;if((l==null?void 0:l.success)==!0)for(let t of(c=l==null?void 0:l.data)==null?void 0:c.requests)new w("personal_another_user_info").callApi({another_userId:t==null?void 0:t.student_id}).then(d=>{(d==null?void 0:d.success)==!0&&((t==null?void 0:t.package_type)=="course"?new w("get_course").callApi({course_id:t==null?void 0:t.course_id}).then(n=>{var p,_,h,f,v;(n==null?void 0:n.success)==!0&&((v=u.value)==null||v.push({id:t==null?void 0:t.id,childEmail:(_=(p=d==null?void 0:d.data)==null?void 0:p.info)==null?void 0:_.email,courseTitle:s((f=(h=n==null?void 0:n.data)==null?void 0:h.course)==null?void 0:f.title),date:x(t==null?void 0:t.created_at),status:t==null?void 0:t.status,price:t==null?void 0:t.price,comments:t==null?void 0:t.comments}),m.value="",u.value.sort((I,E)=>I.id.localeCompare(E.id)))}):(t==null?void 0:t.package_type)=="plan"&&new w("get_plan").callApi({plan_id:t==null?void 0:t.course_id}).then(n=>{var p,_,h,f,v;(n==null?void 0:n.success)==!0&&((v=u.value)==null||v.push({id:t==null?void 0:t.id,childEmail:(_=(p=d==null?void 0:d.data)==null?void 0:p.info)==null?void 0:_.email,courseTitle:s((f=(h=n==null?void 0:n.data)==null?void 0:h.plan)==null?void 0:f.title),date:x(t==null?void 0:t.created_at),status:t==null?void 0:t.status,price:t==null?void 0:t.price,comments:t==null?void 0:t.comments}),m.value="",u.value.sort((I,E)=>I.id.localeCompare(E.id)))}))})})}$();function x(l){const c=new Date(l),t=c.getFullYear(),g=(c.getMonth()+1).toString().padStart(2,"0"),d=c.getDate().toString().padStart(2,"0");return`${t}-${g}-${d}`}const S=y(!1),k=y(-1),m=y("");function V(){let l={enrollment_request_id:u.value[k.value].id,msg:{msg:m.value}};new w("add_comment").callApi(l).then(t=>{t!=null&&t.success&&$()})}function j(l){if(l=="Pending")return s(o.pendding);if(l=="Rejected")return s(o.rejected);if(l=="Success")return s(o.succeess)}return(l,c)=>(b(),C(A,null,[r(z),a("div",G,[r(e(U),{visible:S.value,"onUpdate:visible":c[1]||(c[1]=t=>S.value=t),modal:"",header:e(s)(e(o).showComments),style:{width:"50vw"}},{default:L(()=>[a("div",J,[(b(!0),C(A,null,D(u.value[k.value].comments,t=>(b(),C("div",{class:N(["msg",{admin:(t==null?void 0:t.sender_type)=="Admin",parent:(t==null?void 0:t.sender_type)=="Parent"}])},i(t.msg),3))),256))]),a("div",K,[r(e(M),{modelValue:m.value,"onUpdate:modelValue":c[0]||(c[0]=t=>m.value=t)},null,8,["modelValue"]),r(e(P),{label:e(s)(e(o).addComment),onClick:V},null,8,["label"])])]),_:1},8,["visible","header"]),r(F,{class:"sidebar",selected:"enrollmentsRequests"}),a("div",Q,[a("div",W,[a("h2",null,i(e(s)(e(o).enrollmentRequests)),1),a("div",X,[a("div",Z,[a("h3",null,i(e(s)(e(o).childEmail)),1),a("h3",null,i(e(s)(e(o).courseTitle)),1),a("h3",null,i(e(s)(e(o).price)),1),a("h3",null,i(e(s)(e(o).date)),1),a("h3",null,i(e(s)(e(o).status)),1),a("h3",null,i(e(s)(e(o).actions)),1)]),(b(!0),C(A,null,D(u.value,(t,g)=>(b(),C("div",q,[a("span",null,i(t.childEmail),1),a("span",null,i(t.courseTitle),1),a("span",null,i(t.price)+" L.E.",1),a("span",null,i(t.date),1),a("span",{class:N({pending:t.status=="Pending",rejected:t.status=="Rejected",accepted:t.status=="Success"})},i(j(t.status)),3),a("span",null,[r(e(P),{onClick:d=>{k.value=g,S.value=!0},style:{"font-size":"0.75rem"},label:e(s)(e(o).showComments)},null,8,["onClick","label"])])]))),256))])])])]),r(O)],64))}}),lt=Y(R,[["__scopeId","data-v-b80d7bb3"]]);export{lt as default};
